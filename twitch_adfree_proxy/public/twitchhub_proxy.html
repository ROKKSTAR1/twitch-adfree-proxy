<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Twitch Proxy Hub (Ad-Filter)</title>
<style>
  body{margin:0;font-family:system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,sans-serif;background:#0f1115;color:#fff}
  header{background:#9146FF;padding:12px 14px;font-weight:800;position:sticky;top:0;z-index:10}
  .wrap{padding:12px;display:grid;gap:12px}
  .row{display:flex;gap:8px;align-items:center;flex-wrap:wrap}
  input{background:#101319;border:1px solid #262a33;border-radius:10px;color:#fff;padding:10px 12px;min-width:220px}
  button{background:#9146FF;border:none;color:#fff;border-radius:10px;padding:10px 12px;font-weight:700;cursor:pointer}
  button:hover{background:#772ce8}
  #video{width:100%;max-height:70vh;background:#000}
  .small{font-size:12px;color:#cbd5e1}
</style>
</head>
<body>
<header>Twitch Proxy Hub</header>
<div class="wrap">
  <div class="row">
    <input id="channel" placeholder="Channel login (e.g., pokimane)" />
    <button id="play">Play (via proxy)</button>
  </div>
  <video id="video" controls autoplay playsinline></video>
  <div class="small">
    This demo plays video only (no chat). You can keep your older page for chat or embed Twitch chat separately:<br>
    <code>&lt;iframe src="https://www.twitch.tv/embed/CHANNEL/chat?parent=YOURDOMAIN"&gt;&lt;/iframe&gt;</code>
  </div>
</div>

<!-- hls.js from CDN -->
<script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>
<script>
const playBtn = document.getElementById('play');
const channel = document.getElementById('channel');
const video = document.getElementById('video');

function play(){
  const ch = (channel.value || '').trim().toLowerCase();
  if(!ch){ alert('Type a channel login'); return; }
  const playlist = `${location.origin}/playlist/${encodeURIComponent(ch)}`;
  if(Hls.isSupported()){
    const hls = new Hls({ lowLatencyMode: true, backBufferLength: 60 });
    hls.loadSource(playlist);
    hls.attachMedia(video);
    hls.on(Hls.Events.ERROR, (evt, data) => {
      console.error('HLS error', data);
    });
  }else if(video.canPlayType('application/vnd.apple.mpegurl')){
    video.src = playlist;
  }else{
    alert('HLS not supported in this browser.');
  }
}

playBtn.addEventListener('click', play);
</script>
</body>
</html>
